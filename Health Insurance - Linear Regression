#IMPORTING PACKAGES OF NYMPY AND PANDAS.
import numpy as np
import pandas as pd

#Uploading the data
data=pd.read_csv("/content/insurance2.csv")

#Checking First 5 Rows.
#Step 1 Gathering of data is done.
data.head()

#This will help to get information about the datatype of variables
data.info()

#Now we will be cleaning the data 
#Step 2 Clean the data
#Using Feature Engineering On Hot Encoding  - Will convert categorical variable to numeric values
data['sex']=data['sex'].apply({'male':1, 'female':0}.get)
data['smoker']=data['smoker'].apply({'yes':1, 'no':0}.get)
data['region']=data['region'].apply({'southwest':1, 'southeast':0, 'northwest':3, 'northeast':2}.get)

data.head()

#Now data is cleaned.
#We will work on this data now
#Step 3 We will divide the data into Independent & Dependent Variable
x=data[['age','sex','bmi','children','smoker','region']] #Independent Variable
y=data['expenses'] #Depemdent Variable

#Step 4 Splitting The Data. Into Training & Testing Set
#Training Obj: Learn The Model
#Testing Obj: To Find the accuracy
from sklearn.model_selection import train_test_split
x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.3) 
#Test_size=0.2 means 20% data will be used for testing and
#80% data will be used for Training 

#Step 5 Creating ML Model using Linear Regression Algorithm
from sklearn.linear_model import LinearRegression
model=LinearRegression()  #we are activating the algorithm for use.

#Training The Model using .fit()
model.fit(x_train,y_train)

#.predict used for predicting the future values
y_pred=model.predict(x_test)

#This is the Output Generated By MLM
#y_pred is the amount of Health Insurance as calculated by the ML Model
print(y_pred)

#checking the  accuracy of ML model
#Checking Accuracy we can use Score Function
accuracy=model.score(x,y)

print("The accuracy of the ML model using Linear Regression Algorithm is", accuracy)

#Predicting The Health Insurance of a new customer
#Creating data for new customer
data_new={'age':32,'sex':0,'bmi':22,'children':0,'smoker':0,'region':1}

#Converting THe Dictionary to DataFrame
index=[1] #Serial No
my_data=pd.DataFrame(data_new,index)

print(my_data)

#Predicting The amount of Health Insurance the new customer gets.
y_pred=model.predict(my_data)

print('The amount of Health Insurance the new customer gets is', y_pred)
